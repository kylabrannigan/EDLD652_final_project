---
title: "Walkability Index"
authors: Cheyna Warner, Erika Davis, & Kyla Brannigan
output:
  flexdashboard::flex_dashboard:
    theme:
      version: 4
      bg: "#FFF5F5"
      fg: "#000000" 
      primary: "#5E9C07"

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(rio)
library(tidyverse)
library(here)
```

# Importing and Clearning the Data

Here, we are importing and cleaning our data for analysis.
```{r}
smart_location <- import(here("data", "EPA_SmartLocationDatabase_V3_Jan_2021_Final.csv")) #smart location database and walkability index 

crash <- import(here("FARS2019NationalCSV", "accident.csv")) #crash data

# Walkability Data Cleaning

walkability <- smart_location %>% 
  select(CBSA, CBSA_Name, CBSA_POP, CBSA_EMP, CBSA_WRK, # select col of interest
         TotPop, AutoOwn0, AutoOwn1, AutoOwn2p, 
         NatWalkInd, 
         TotEmp, E5_Ret, E5_Off, E5_Ind, E5_Svc, E5_Ent,
         E_LowWageWk, E_MedWageWk, E_HiWageWk)

walkability$City <- gsub(",.*$", "", walkability$CBSA_Name) # make new col that indicates city
walkability$State <- sub("^.*?,\\s*", "", walkability$CBSA_Name) # make new col that indicates state

states_list <- c("AL", "AK", "AZ", "AR", "CA", "CO", "CT", "DE", "FL", "GA", "HI", "ID", "IL", "IN", "IA", "KS", "LA", "ME", "MD", "MA", "MI", "MN", "MS", "MO", "MT", "NE", "NV", "NH", "NJ", "NM", "NY", "NC", "ND", "OH", "OK", "OR", "PA", "RI", "SC", "SD", "TN","TX", "UT", "VT", "VA", "WA", "WV", "WI", "WY")

walkability <- walkability %>%
  select(State %in% states_list)

# Crash Data Filtering
crash <- crash %>% 
  select(STATENAME, RUR_URBNAME, HARM_EVNAME, FATALS)
```

# Location and Walkability
completed by Kyla Brannigan

### Map with color gradient showing concentration of walkable cities

```{r}

```


# Pedestrian crash data and Walkability 
completed by Erika Davis

###  What is the relationship between walkability and pedestrian crash data? 

```{r}

```

### How are crash rates impacted by the most common mode of transportation? (bar graph)

```{r}

```
 

# Lifestyle and Walkability
completed by Cheyna Warner

### do more walkable cities have fewer cars? 

```{r}
car_rates <- walkability %>% 
  select(CBSA, CBSA_Name, AutoOwn0, AutoOwn1, AutoOwn2p,NatWalkInd, City, State) %>% 
  group_by(City, NatWalkInd) %>% 
  mutate(car = sum(AutoOwn1+AutoOwn2p))

car_rates$car <- as.factor(car_rates$car)

car_rates_plot <- car_rates %>% 
  ggplot(aes(x = car, fill = State))+
  geom_bar()

car_rates_plot
```
 
### are unemployment rates lower in walkable areas?

```{r}

```

